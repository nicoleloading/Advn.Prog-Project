{% extends 'base.html' %}

{% block title %}Register - Attendance System{% endblock %}

{% block extra_css %}
<style>
    body { background: linear-gradient(135deg, #a01515 0%, #ac2020 100%); min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 30px; }
    .container { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); width: 500px; max-width: 90%; max-height: 85vh; overflow-y: auto; }
    h2 { color: #333; margin-bottom: 25px; text-align: center; font-size: 28px; }
    .form-group { margin-bottom: 18px; }
    label { display: block; margin-bottom: 6px; color: #555; font-weight: 500; font-size: 14px; }
    input, select { width: 100%; padding: 11px 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px; transition: border-color 0.3s; }
    input:focus, select:focus { outline: none; border-color: #ea6666; box-shadow: 0 0 0 3px rgba(234, 102, 102, 0.1); }
    button { width: 100%; padding: 13px; background: #ea6666; color: white; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; font-weight: 600; margin-top: 10px; transition: background 0.3s; }
    button:hover { background: #d55555; }
    .links { text-align: center; margin-top: 20px; }
    .links a { color: #ea6666; text-decoration: none; font-weight: 500; }
    .links a:hover { text-decoration: underline; }
    .hidden { display: none; }
    .role-indicator { background: #f8f9fa; padding: 10px 15px; border-radius: 5px; margin-bottom: 20px; text-align: center; color: #666; font-size: 14px; border-left: 4px solid #ea6666; }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <h2>Register Account</h2>
    <form method="POST">
        <div class="form-group">
            <label>Select Role</label>
            <select name="role" id="roleSelect" required>
                <option value="student">Student</option>
                <option value="professor">Professor</option>
            </select>
        </div>

        <div id="roleIndicator" class="role-indicator">
            Registering as: <strong id="roleText">Student</strong>
        </div>

        <!-- Student Fields -->
        <div id="studentFields">
            <div class="form-group">
                <label>Student ID</label>
                <input type="text" name="student_id" id="studentId">
            </div>
            <div class="form-group">
                <label>Name</label>
                <input type="text" name="name" id="studentName">
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="email" name="email" id="studentEmail">
            </div>
            <div class="form-group">
                <label>Program</label>
                <input type="text" name="program" id="program">
            </div>
            <div class="form-group">
                <label>Year</label>
                <select name="year" id="year">
                    <option value="1">1st Year</option>
                    <option value="2">2nd Year</option>
                    <option value="3">3rd Year</option>
                    <option value="4">4th Year</option>
                </select>
            </div>
        </div>

        <!-- Professor Fields -->
        <div id="professorFields" class="hidden">
            <div class="form-group">
                <label>Professor ID</label>
                <input type="text" name="prof_id" id="profId">
            </div>
            <div class="form-group">
                <label>Name</label>
                <input type="text" name="prof_name" id="profName">
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="email" name="prof_email" id="profEmail">
            </div>
            <div class="form-group">
                <label>Course</label>
                <input type="text" name="course" id="course">
            </div>
            <div class="form-group">
                <label>Course ID</label>
                <input type="text" name="course_id" id="courseId">
            </div>
            <div class="form-group">
                <label>Schedule</label>
                <input type="text" name="schedule" id="schedule" placeholder="e.g., MWF 10:00-11:30">
            </div>
        </div>

        <div class="form-group">
            <label>Password</label>
            <input type="password" name="password" id="password" required>
        </div>

        <button type="submit">Register</button>
    </form>
    <div class="links">
        <a href="{{ url_for('auth.login') }}">Already have an account? Login</a>
    </div>
</div>

<script>
    const roleSelect = document.getElementById('roleSelect');
    const studentFields = document.getElementById('studentFields');
    const professorFields = document.getElementById('professorFields');
    const roleText = document.getElementById('roleText');

    // Function to toggle fields and their required status
    function toggleFields() {
        const isStudent = roleSelect.value === 'student';
        
        // Update role indicator text
        roleText.textContent = isStudent ? 'Student' : 'Professor';
        
        if (isStudent) {
            studentFields.classList.remove('hidden');
            professorFields.classList.add('hidden');
            
            // Set student fields as required
            document.getElementById('studentId').required = true;
            document.getElementById('studentName').required = true;
            document.getElementById('studentEmail').required = true;
            document.getElementById('program').required = true;
            document.getElementById('year').required = true;
            
            // Remove required from professor fields
            document.getElementById('profId').required = false;
            document.getElementById('profName').required = false;
            document.getElementById('profEmail').required = false;
            document.getElementById('course').required = false;
            document.getElementById('courseId').required = false;
            document.getElementById('schedule').required = false;
        } else {
            studentFields.classList.add('hidden');
            professorFields.classList.remove('hidden');
            
            // Remove required from student fields
            document.getElementById('studentId').required = false;
            document.getElementById('studentName').required = false;
            document.getElementById('studentEmail').required = false;
            document.getElementById('program').required = false;
            document.getElementById('year').required = false;
            
            // Set professor fields as required
            document.getElementById('profId').required = true;
            document.getElementById('profName').required = true;
            document.getElementById('profEmail').required = true;
            document.getElementById('course').required = true;
            document.getElementById('courseId').required = true;
            document.getElementById('schedule').required = true;
        }
    }

    // Listen for role changes
    roleSelect.addEventListener('change', toggleFields);
    
    // Initialize on page load
    toggleFields();
</script>
{% endblock %}